!function(){function i(){var e=a(['\n  mutation CreateVisitor(\n    $visitorInsertObject: visitor_insert_input! = { visitor_first_name: "", visitor_last_name: "", visitor_phone: "", visitor_email: "" }\n  ) {\n    insert_visitor_one(\n      object: $visitorInsertObject\n      on_conflict: { constraint: visitor_visitor_first_name_visitor_last_name_visitor_phone__key, update_columns: updated_at }\n    ) {\n      visitor_uuid\n    }\n  }\n']);return i=function(){return e},e}function e(){var i=a(['\n  query PlaceDetails($placeUUIDEquals: uuid! = "875b4319-5b1c-44ef-9950-bc6004c4f77a") {\n    place(where: { place_uuid: { _eq: $placeUUIDEquals } }, distinct_on: place_uuid) {\n      business_name\n      place_name\n      place_description\n      place_capacity\n      place_address\n      place_stay_estimate_minutes\n    }\n  }\n']);return e=function(){return i},i}function t(){var i=a(['\n  subscription PlaceVisitorsCurrentCount($placeUUIDEquals: uuid! = "") {\n    visit_aggregate(\n      where: {\n        _and: { place_uuid: { _eq: $placeUUIDEquals }, checked_out_at: { _is_null: true }, checked_in_at: { _is_null: false } }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n  }\n']);return t=function(){return i},i}function n(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function o(i,e,t){return e&&n(i.prototype,e),t&&n(i,t),i}function c(){var i=a(['\n  mutation CheckOutVisitor(\n    $place_uuid: uuid! = "875b4319-5b1c-44ef-9950-bc6004c4f77a"\n    $visitor_uuid: uuid! = "e3f2445c-c497-4f3f-a43a-a8256da64fd7"\n    $checked_in_at: timestamptz! = "2020-08-10T11:40:26.119331+00:00"\n  ) {\n    update_visit_by_pk(\n      pk_columns: { place_uuid: $place_uuid, visitor_uuid: $visitor_uuid, checked_in_at: $checked_in_at }\n      _set: { checked_out_at: "now()" }\n    ) {\n      checked_out_at\n    }\n  }\n']);return c=function(){return i},i}function r(){var i=a(['\n  mutation StartVisitCheckIn($place_uuid: uuid! = "875b4319-5b1c-44ef-9950-bc6004c4f77a", $visitor_uuid: uuid! = "") {\n    insert_visit_one(object: { place_uuid: $place_uuid, visitor_uuid: $visitor_uuid }) {\n      checked_in_at\n      visitor_uuid\n      visitor {\n        visitor_first_name\n      }\n    }\n  }\n']);return r=function(){return i},i}function a(i,e){return e||(e=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(e)}}))}function s(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{CbZG:function(n,a,u){"use strict";u.r(a),u.d(a,"VisitorPageModule",(function(){return J}));var l,b=u("SVse"),d=u("s7LF"),v=u("sZkV"),h=u("iInd"),p=u("pLZG"),f=u("lJxs"),m=function i(){return s(this,i),new d.d({visitor_first_name:new d.b("",[d.m.required,d.m.minLength(1)]),visitor_last_name:new d.b("",[d.m.required,d.m.minLength(1)]),visitor_phone:new d.b("",[d.m.required,d.m.minLength(10)]),visitor_email:new d.b("",d.m.compose([d.m.required,d.m.pattern("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$")]))})},_=u("8Y7J"),k=u("ALmS"),g=u("nbgS"),I=k.gql(r()),y=k.gql(c()),C=((l=function(){function i(e){s(this,i),this.apollo=e}return o(i,[{key:"createCheckInVisitor",value:function(i,e){return console.log("CheckInOutService -> constructor -> place_uuid",i),console.log("CheckInOutService -> constructor -> visitor_uuid",e),this.apollo.mutate({mutation:I,variables:{place_uuid:i,visitor_uuid:e}})}},{key:"updateCheckOutVisitor",value:function(i,e,t){return console.log("CheckInOutService -> constructor -> checked_in_at",t),this.apollo.mutate({mutation:y,variables:{place_uuid:i,visitor_uuid:e,checked_in_at:t}})}}]),i}()).\u0275fac=function(i){return new(i||l)(_.Rb(g.b))},l.\u0275prov=_.Eb({token:l,factory:l.\u0275fac,providedIn:"root"}),l);k.gql(t());var U,D,O=k.gql(e()),M=((U=function(){function i(e){s(this,i),this.apollo=e}return o(i,[{key:"getPlaceDetails",value:function(i){return this.apollo.query({query:O,variables:{placeUUIDEquals:i}})}}]),i}()).\u0275fac=function(i){return new(i||U)(_.Rb(g.b))},U.\u0275prov=_.Eb({token:U,factory:U.\u0275fac,providedIn:"root"}),U),N=k.gql(i()),w=((D=function(){function i(e){s(this,i),this.apollo=e}return o(i,[{key:"createVisitor",value:function(i){var e=i.visitor_first_name,t=i.visitor_last_name,n=i.visitor_phone,o=i.visitor_email;return this.apollo.mutate({mutation:N,variables:{visitorInsertObject:{visitor_first_name:e,visitor_last_name:t,visitor_phone:n,visitor_email:o}},errorPolicy:"all"})}}]),i}()).\u0275fac=function(i){return new(i||D)(_.Rb(g.b))},D.\u0275prov=_.Eb({token:D,factory:D.\u0275fac,providedIn:"root"}),D);function V(i,e){if(1&i&&(_.Lb(0),_.lc(1),_.Yb(2,"date"),_.Kb()),2&i){var t=_.Xb();_.yb(1),_.nc(" Checked in at ",_.Zb(2,1,t.checkedInDateTime)," ")}}function P(i,e){if(1&i){var t=_.Ob();_.Nb(0,"ion-button",19),_.Vb("click",(function(i){return _.gc(t),_.Xb().clickCheckIn(i)})),_.lc(1),_.Mb()}if(2&i){var n=_.Xb();_.cc("disabled",void 0===n.visitUUIDForCheckin),_.yb(1),_.nc("Check in ",n.visitUUIDForCheckin,"")}}function F(i,e){if(1&i&&(_.Lb(0),_.lc(1),_.Yb(2,"date"),_.Kb()),2&i){var t=_.Xb();_.yb(1),_.nc(" Thank you for checking out at ",_.Zb(2,1,t.checkedInDateTime)," ")}}function j(i,e){if(1&i){var t=_.Ob();_.Nb(0,"ion-button",19),_.Vb("click",(function(i){return _.gc(t),_.Xb().clickCheckOut(i)})),_.lc(1),_.Mb()}if(2&i){var n=_.Xb();_.cc("disabled",void 0===n.visitUUIDForCheckin),_.yb(1),_.nc(" Check out ",n.visitUUIDForCheckin," ")}}function q(i){console.log("VisitorPage:: getVisitorFieldsFromParamMap -> paramMap",i);var e=i.params;return console.log("VisitorPage:: extractHotlinkedVisitorParams -> unsafeExtractionObject",e),function(i){return{visitor_first_name:i.firstName,visitor_last_name:i.lastName,visitor_email:i.email,visitor_phone:i.phone}}(e)}var S,$,x,Z=[{path:"",component:(S=function(){function i(e,t,n,o,c){var r,a;s(this,i),this.activatedRoute=e,this.formBuilder=t,this.checkInOutService=n,this.placeService=o,this.visitorService=c,this.placeUUID=e.snapshot.paramMap.get("placeUUID"),console.log("VisitorPage -> constructor -> this.placeUUID",this.placeUUID),(r=e,a=r.paramMap,console.log("VisitorPage:: activatedRouteParamMap",a),a.pipe(Object(f.a)(q))).subscribe((function(i){console.log("VisitorPage -> constructor -> extractedVisitor",i)})),this.visitorForm=new m;var u=o.getPlaceDetails("875b4319-5b1c-44ef-9950-bc6004c4f77a");u.subscribe((function(i){var e=i.data,t=i.error,n=i.errors,o=i.loading,c=i.networkStatus,r=i.partial;console.log("VisitorPage:: getPlaceDetails() -> error",t,n,o,c,r),console.log("VisitorPage:: getPlaceDetails() -> data",e)}));var l=u.pipe(Object(p.a)((function(i){var e,t;return void 0!==(null===(t=null===(e=i.data)||void 0===e?void 0:e.place)||void 0===t?void 0:t[0])})),Object(f.a)((function(i){return i.data.place[0]})));this.placeDetails=l,this.placeDeets=o.getPlaceDetails("875b4319-5b1c-44ef-9950-bc6004c4f77a")}return o(i,[{key:"ngOnInit",value:function(){}},{key:"submitForm",value:function(i){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.visitorForm,n=t.invalid,o=t.value,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.visitorService;console.log("VisitorPage -> submitForm -> event",i),n||c.createVisitor(o).subscribe((function(i){var t,n;console.log("VisitorPage -> submitForm -> visitorResult",i),e.visitUUIDForCheckin=null===(n=null===(t=i.data)||void 0===t?void 0:t.insert_visitor_one)||void 0===n?void 0:n.visitor_uuid}))}},{key:"clickCheckIn",value:function(i){var e=this;console.log("clickCheckIn -> event",i),void 0!==this.visitUUIDForCheckin&&(this.checkedInObs=this.checkInOutService.createCheckInVisitor(this.placeUUID,this.visitUUIDForCheckin),this.checkedInObs.subscribe((function(i){var t,n,o=i.data,c=i.errors,r=i.context,a=i.extensions;console.log("clickCheckIn -> data",o,c,r,a),e.checkedInDateTime=new Date(null===(t=null==o?void 0:o.insert_visit_one)||void 0===t?void 0:t.checked_in_at),e.checkedInTimestampStringIdentifier=null===(n=null==o?void 0:o.insert_visit_one)||void 0===n?void 0:n.checked_in_at})))}},{key:"clickCheckOut",value:function(i){var e=this;console.log("clickCheckOut -> event",i),void 0!==this.visitUUIDForCheckin&&void 0!==this.checkedInDateTime&&void 0!==this.checkedInTimestampStringIdentifier&&(this.checkedOutObs=this.checkInOutService.updateCheckOutVisitor(this.placeUUID,this.visitUUIDForCheckin,this.checkedInTimestampStringIdentifier),this.checkedOutObs.subscribe((function(i){var t,n=i.data,o=i.errors,c=i.context,r=i.extensions;console.log("clickCheckOut -> data",n,o,c,r),e.checkedOutDateTime=new Date(null===(t=null==n?void 0:n.update_visit_by_pk)||void 0===t?void 0:t.checked_out_at)})))}}]),i}(),S.\u0275fac=function(i){return new(i||S)(_.Ib(h.a),_.Ib(d.a),_.Ib(C),_.Ib(M),_.Ib(w))},S.\u0275cmp=_.Cb({type:S,selectors:[["app-visitor"]],decls:61,vars:27,consts:[["src","/assets/images/les-logo-256px-min.png","alt","Placeholder-image",2,"width","12em"],[3,"formGroup","ngSubmit"],["f","ngForm"],["src","/assets/images/les-logo-1-min-4kB.png","alt","Placeholder-image"],[2,"padding-left","0.5em","max-width","fit-content"],[2,"padding-left","0.55em"],["name","people"],["position","floating"],["formControlName","visitor_first_name","type","text","required",""],["formControlName","visitor_last_name","type","text","required",""],["formControlName","visitor_phone","type","tel","size","12","required",""],["formControlName","visitor_email","type","text","required",""],["icon-only","","size","block",3,"disabled","click"],["name","person-add-outline","slot","icon-only"],["type","submit"],[4,"ngIf","ngIfElse"],["pendingCheckIn",""],["pendingCheckOut",""],["color","light"],[3,"disabled","click"]],template:function(i,e){if(1&i&&(_.Nb(0,"ion-header"),_.Nb(1,"ion-toolbar"),_.Nb(2,"ion-title"),_.lc(3,"Checki\u2705"),_.Mb(),_.Mb(),_.Mb(),_.Nb(4,"ion-content"),_.Nb(5,"ion-card"),_.Nb(6,"ion-card-header"),_.lc(7,"Place"),_.Mb(),_.Nb(8,"ion-card-title"),_.lc(9," Logan Endoscopy Services "),_.Mb(),_.Jb(10,"img",0),_.Nb(11,"ion-card-subtitle"),_.lc(12,"subtitle"),_.Mb(),_.Mb(),_.lc(13),_.Nb(14,"form",1,2),_.Vb("ngSubmit",(function(i){return e.submitForm(i)})),_.Nb(16,"ion-list"),_.Nb(17,"ion-list-header"),_.Nb(18,"ion-avatar"),_.Jb(19,"img",3),_.Mb(),_.Nb(20,"ion-label"),_.Jb(21,"h1",4),_.Nb(22,"h2",5),_.Jb(23,"ion-icon",6),_.Mb(),_.Jb(24,"h3"),_.Mb(),_.Mb(),_.Nb(25,"ion-item"),_.Nb(26,"ion-label",7),_.lc(27," First name "),_.Mb(),_.Jb(28,"ion-input",8),_.Mb(),_.Nb(29,"ion-item"),_.Nb(30,"ion-label",7),_.lc(31," Last name "),_.Mb(),_.Jb(32,"ion-input",9),_.Mb(),_.Nb(33,"ion-item"),_.Nb(34,"ion-label",7),_.lc(35," Phone number "),_.Mb(),_.Jb(36,"ion-input",10),_.Mb(),_.Nb(37,"ion-item"),_.Nb(38,"ion-label",7),_.lc(39," Email address "),_.Mb(),_.Jb(40,"ion-input",11),_.Mb(),_.Mb(),_.Nb(41,"ion-button",12),_.Vb("click",(function(i){return e.submitForm(i)})),_.Jb(42,"ion-icon",13),_.Mb(),_.Jb(43,"button",14),_.Mb(),_.jc(44,V,3,3,"ng-container",15),_.jc(45,P,2,2,"ng-template",null,16,_.kc),_.jc(47,F,3,3,"ng-container",15),_.jc(48,j,2,2,"ng-template",null,17,_.kc),_.lc(50),_.Yb(51,"json"),_.Yb(52,"async"),_.Yb(53,"json"),_.Yb(54,"async"),_.Nb(55,"ion-text",18),_.lc(56),_.Yb(57,"json"),_.Yb(58,"async"),_.Yb(59,"json"),_.Yb(60,"async"),_.Mb(),_.Mb()),2&i){var t=_.fc(46),n=_.fc(49);_.yb(13),_.nc(" ",e.visitUUIDForCheckin," "),_.yb(1),_.cc("formGroup",e.visitorForm),_.yb(27),_.cc("disabled",e.visitorForm.invalid),_.yb(3),_.cc("ngIf",e.checkedInDateTime)("ngIfElse",t),_.yb(3),_.cc("ngIf",e.checkedOutDateTime)("ngIfElse",n),_.yb(3),_.oc(" ",_.Zb(51,11,_.Zb(52,13,e.checkedInObs))," ",_.Zb(53,15,_.Zb(54,17,e.checkedOutObs))," "),_.yb(6),_.oc(" ",_.Zb(57,19,_.Zb(58,21,e.placeDetails))," Test 2 ",_.Zb(59,23,_.Zb(60,25,e.placeDeets))," ")}},directives:[v.l,v.w,v.v,v.k,v.g,v.h,v.j,v.i,d.n,d.j,d.e,v.q,v.r,v.b,v.p,v.m,v.o,v.n,v.B,d.i,d.c,d.l,v.e,b.l,v.u],pipes:[b.g,b.b,b.e],styles:[".submit-enter[_ngcontent-%COMP%]{position:absolute;visibility:hidden;left:-1000px}"]}),S)}],E=((x=function i(){s(this,i)}).\u0275mod=_.Gb({type:x}),x.\u0275inj=_.Fb({factory:function(i){return new(i||x)},imports:[[h.i.forChild(Z)],h.i]}),x),J=(($=function i(){s(this,i)}).\u0275mod=_.Gb({type:$}),$.\u0275inj=_.Fb({factory:function(i){return new(i||$)},imports:[[b.c,d.f,d.k,v.x,E]]}),$)}}])}();